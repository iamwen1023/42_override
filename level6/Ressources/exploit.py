from sys import exit, argv

if (len(argv) < 2):
	print("Error: Please provide the buffer from which you want to calculate the serial")
	exit(1)

val = str(argv[1])
if (len(val) < 4):
	print("Error: Input must be at least 4 characters long.")
	exit(1)

local_char = (ord(val[3]) ^ 4919) + 0x5eeded
for i in range(len(val)):
	local_char += (ord(val[i]) ^ local_char) % 1337

print(f"For the '\x1b[32m{val}\x1b[0m' buffer, you can try the '\x1b[32m{local_char}\x1b[0m' serial")